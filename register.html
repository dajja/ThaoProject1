<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
        integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="trang1.css">
</head>
<style>
    .container2 {
        background-color: linear-gradient(to right, rgba(255, 0, 0, 0), rgba(26, 202, 140));
        background-color: sienna;
        width: 250px;
        margin: 40px auto;
        height: 540px;
        box-sizing: border-box;
        padding: 40px;
        border-radius: 5px;
        color: black;
        position: relative;
        margin-top: -600px;
    }

    .container2 input {
        margin: 5px 0px;
        width: 150px;
        height: 20px;
        outline: none;
        padding: 5px;
        border-radius: 5px;
        border: none;
    }

    .container2 button {
        display: block;
        margin: 0 auto;
        height: 25px;
        background-color: antiquewhite;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 10px;
        margin-bottom: 10px;
        box-shadow: 1px 1px 3px 3px tomato;
    }

    .container2 button:hover {
        cursor: pointer;
        background-image: linear-gradient(to right, blue, yellow);
        outline: none;
    }

    .body {
        width: 100%;
        height: 100%;
        padding: 10px;
    }

    .body i {
        position: absolute;
        left: 165px;
        margin-top: 8px;
        cursor: pointer;
    }

    .okAcount {
        position: relative;
        left: 0px;
    }

    #icon {
        margin-left: 15px;
    }

    #iconClose {
        margin-left: 15px;
    }
</style>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-primary py-3">
        <div class="container"><a href="trang1.html" class="navbar-brand d-flex align-items-center"> <i
                    class="fa-solid fa-book-open-reader"></i> &nbsp; <strong> Readnews </strong></a>
            <button type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"
                class="navbar-toggler"><span class="navbar-toggler-icon"></span></button>
            <div id="navbarSupportedContent" class="collapse navbar-collapse">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active"><a href="trangchu.html" class="nav-link font-italic"> CONTINUE </a> </li>
                    <li class="nav-item active"><a href="index.html" class="nav-link font-italic"> LOGIN </a> </li>
                </ul>
            </div>
        </div>
    </nav>
    <img class="image"
        src="https://media.istockphoto.com/vectors/world-map-background-concept-vector-id1287056904?k=20&m=1287056904&s=612x612&w=0&h=RpKZaNol-12Wk3q5UmwLmoPWqc8koTWzuUuh9fPp8GU="
        alt="error">
    <div class="container2">
        <h2 style="text-align: center;"> Đăng kí</h2>
        <div class="body">
            <label for="">Tên đăng nhập</label><br>
            <input id='username' type="text" placeholder="Username">
            <span class="errorUserName" id="errorUserName" style="display: none">Username sai dinh dang</span><br>
            <label for="email"> Email </label> <br>
            <input id="email" type="text" placeholder="Email"> <br>
            <span id="emailExits" style="display:none"> Trung email </span>
            <span class="errorMail" id="errorEmail" style="display: none">Mail sai dinh dang</span>
            <label for="password"> Mật khẩu </label> <br>
            <i id="icon" onclick="showPassword()" class="fa-solid fa-eye"></i>
            <input id="password" type="password" placeholder="Password"> <br>
            <span class="error" id="error" style="display: none">Password sai định dạng</span>
            <label for="confirmPassword"> Nhập lại mật khẩu </label> <br>
            <i id="iconClose" onclick="showConfirmPassword()" class="fa-solid fa-eye"></i>
            <input id="confirmPassword" type="password" placeholder="Confirm Password"> <br>
            <p id="confirmError" style="display: none">Password nhập không khớp</p>
            <button id="button" onclick="register()"> Đăng ký </button>
         
            <div class="okAcount">
                Bạn đã có tài khoản. <br> <a href="index.html">Đăng nhập</a>
            </div>

        </div>
        <script>
            function checkUserName(username) {
                // let username = document.getElementById('username').value
                let re = /^[a-zA-Z0-9\-]+$/
                if (re.test(username)) {
                    return true
                } else {
                    return false
                }
            }
            function checkMail(mail) {
                //let mail = document.getElementById('email').value;
                let re = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
                if (re.test(mail)) {
                    return true
                } else {
                    return false;
                }
            }
            function register() {
                let username = document.getElementById('username').value;
                let errorUserName = document.getElementById("errorUserName");
                if (checkUserName(username) == false) {
                    errorUserName.setAttribute("style", "display:block; color:blue");
                } else {
                    errorUserName.setAttribute("style", "display:none");
                    document.getElementById("username").value = "";
                }
                let mail = document.getElementById("email").value;
                let errorMail = document.getElementById("errorEmail");
                if (checkMail(mail) == false) {
                    errorMail.setAttribute("style", "display:block; color:blue");
                    document.getElementById("email").value = "";
                } else {
                    errorMail.setAttribute("style", "display:none");
                    document.getElementById("email").value = "";
                }
                let pass = document.getElementById("password").value;
                let p = document.getElementById("error");
                if (pass.length < 6 || pass.indexOf(" ") != -1) {
                    p.setAttribute("style", "display:block;color:blue")
                    document.getElementById("password").value = "";
                }  else {
                    p.setAttribute("style", "display:none");
                    document.getElementById("password").value = "";
                }
                let pConfirm = document.getElementById("confirmError");
                let passConfirm = document.getElementById("confirmPassword").value;
                if (passConfirm !== pass) {
                    pConfirm.setAttribute("style", "display:block;color:blue");
                    document.getElementById("confirmPassword").value = "";
                } else {
                    pConfirm.setAttribute("style", "display:none");
                    document.getElementById("confirmPassword").value = "";
                }
                if (checkUserName(username) && checkMail(mail) && (pass.length >= 6 && pass.indexOf(" ") == -1) && (passConfirm == pass)) {
                    let obj = {
                        username: username,
                        email: mail,
                        password: pass 
                    }
                    let getInformation = localStorage.getItem("information");
                    if (getInformation == null) {
                        getInformation = [];
                        getInformation.push(obj);
                        localStorage.setItem("information", JSON.stringify(getInformation));
                        window.location.href = "index.html";
                    } else {
                        getInformation = localStorage.getItem("information");
                        getInformation = JSON.parse(getInformation);
                        let emailExits = document.getElementById("emailExits");
                        let flag = false;
                        for (let i = 0; i < getInformation.length; i++) {
                            if (obj.email == getInformation[i].email) {
                                console.log("Trùng email");
                                emailExits.setAttribute("style", "display:block;color:blue");
                                flag = false;
                                return;
                            } else {
                                flag = true;
                            }
                        }
                        if (flag == true) {
                            emailExits.setAttribute("style", "display:none");
                            getInformation.push(obj);
                            localStorage.setItem("information", JSON.stringify(getInformation));
                            window.location.href = "index.html";
                        }
                    }
                }
            }
            function showPassword() {
                //lấy element ô input có id="password"
                let password = document.getElementById("password");
                let icon = document.getElementById("icon");
                if (password.type == "password") {
                    password.type = "text";
                    icon.classList.remove("fa-eye");
                    icon.classList.add("fa-eye-slash");
                } else {
                    password.type = "password";
                    icon.classList.remove("fa-eye-slash");
                    icon.classList.add("fa-eye");
                }
            }
            // <i class="fa-solid fa-eye"></i>
            // <i class="fa-solid fa-eye-slash"></i>
            function showConfirmPassword() {
                let showConfirmPassword = document.getElementById("confirmPassword");
                let iconClose = document.getElementById("iconClose");
                if (showConfirmPassword.type == "password") {
                    showConfirmPassword.type = "text";
                    iconClose.classList.remove("fa-eye");
                    iconClose.classList.add("fa-eye-slash");
                } else {
                    showConfirmPassword.type = "password";
                    iconClose.classList.remove("fa-eye-slash");
                    iconClose.classList.add("fa-eye");
                }
            }

        </script>
</body>

</html>
